<h2 id="volatility-extract-password-from-ram">Volatility: Extract Password from RAM</h2>

<p>Hello everyone. Today’s topic will be volatility: Extract Password from RAM, as well as information about Windows 7 SP1x86 via Volatility Framework. This notion came from a University Professor who remarked something interesting: RAM can store information while ROM is used for reading. Remember that, in contrast to non-volatile memory, volatile memory is computer memory that requires electricity to maintain the recorded information. It holds its contents while switched on, but when the power is interrupted, the stored data is quickly lost.</p>

<p>Perhaps you are wondering what this volatility framework is and what it is used for. Volatility is a free and open source software tool that analyzes RAM (Random Access Memory) in 32 and 64 bit computers. It can analyze Linux, Windows, Mac, and Android systems. It is Python-based and may be operated on Windows, Linux, and Mac computers. It is capable of analyzing raw dumps, crash dumps, VMware dumps (.vmem), virtual box dumps, and many other types of data.</p>

<p>The first step is to obtain a RAM dump from Windows. I made advantage of <a href="https://qpdownload.com/dumpit/?fbclid=IwAR1l_gJfhfCjOc7rUhXXJCXg3UvU79IZaJkFD63DyJjt2exABKoRo0MgrSQ">Dumpit</a>.</p>

<p><img src="/assets/img/headers/forensics/forensics1.png" alt="forensics" /></p>

<p>Installing Volatility Framework is necessary in order to analyze this raw file. Installing requires the following: You must install the following packages and dependencies in order to install this framework on Linux. The following recommended packages for Linux may require you to install a few other packages or libraries as prerequisites.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get <span class="nb">install </span>pcregrep libpcre++-dev python-dev <span class="nt">-y</span> 
</pre></td></tr></tbody></table></code></pre></div></div>

<ul>
  <li>Distorm3 - Powerful Disassembler Library For x86/AMD64.</li>
  <li>Yara - A malware identification and classification tool.</li>
  <li>Pycrypto -  The Python Cryptography Toolkit.</li>
</ul>

<p>I therefore decide to create a small bash script to install this program. Find this  here <a href="https://github.com/T3jv1l/Volatility-Installer">https://github.com/T3jv1l/Volatility-Installer</a>.</p>

<p><img src="/assets/img/headers/forensics/forensics2.png" alt="forensics" /></p>

<p><img src="/assets/img/headers/forensics/forensics3.png" alt="forensics" /></p>

<p><img src="/assets/img/headers/forensics/forensics4.png" alt="forensics" /></p>

<p>In order to use Volatility for analysis, we must first set up a profile that informs Volatility of the operating system the dump was created on, such as Windows 7, Linux, or Mac OS.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre> ./vol.py imageino –f <span class="s2">"Destination of the memory Dump"</span>
</pre></td></tr></tbody></table></code></pre></div></div>
<p><img src="/assets/img/headers/forensics/forensics5.png" alt="forensics" /></p>

<p>As can be seen, Volatility advises using the <code class="language-plaintext highlighter-rouge">Win7SP0x86</code> and <code class="language-plaintext highlighter-rouge">Win7SP1x86</code> profiles.</p>

<p>It’s time to use <code class="language-plaintext highlighter-rouge">--profile=Win7SP1x86</code> and hivelist to find the entire paths to the matching hive on disk as well as the virtual addresses of registry hives in memory. Visit <a href="https://docs.microsoft.com/en-us/windows/desktop/sysinfo/registry-hives">https://docs.microsoft.com/en-us/windows/desktop/sysinfo/registry-hives</a> for additional information about Registry Hives.</p>

<p><img src="/assets/img/headers/forensics/forensics6.png" alt="forensics" /></p>

<p>What do we have? If it’s clear, we search for a virtual address. Why did I select SAM in <code class="language-plaintext highlighter-rouge">%SystemRoot%/system32/config/SAM</code>? Due to the fact that user passwords are kept in a registry hive in a hashed format, either as an LM hash or an NTLM hash. This file is mounted on HKLM/SAM and may be located in <code class="language-plaintext highlighter-rouge">%SystemRoot%/system32/config/SAM</code>. This is the value <code class="language-plaintext highlighter-rouge">0x96754008</code>.</p>

<p>Inside the registry key <code class="language-plaintext highlighter-rouge">HKLM\SYSTEM\CurrentControlSet\Control\hivelist</code> is the Registry Machine System.The registry tree holds data for managing device settings and various aspects of system initialization. This is <code class="language-plaintext highlighter-rouge">0x8ac1c008</code>.</p>

<p>Today, we obtain credentials using hashdump.To use hashdump, enter the virtual addresses of the SYSTEM and SAM hives as <code class="language-plaintext highlighter-rouge">-y</code> and <code class="language-plaintext highlighter-rouge">-s</code>, respectively, as follows:</p>

<p><img src="/assets/img/headers/forensics/forensics7.png" alt="forensics" /></p>

<p>Boom we have a credentials about password , i made a little video about this technique, you can found here : <a href="https://youtu.be/YVv2B4D_ysg">https://youtu.be/YVv2B4D_ysg</a>.</p>

<p><img src="/assets/img/headers/forensics/forensics8.png" alt="forensics" /></p>

<p>Decrypt this hash.</p>

<p><img src="/assets/img/headers/forensics/forensics9.png" alt="forensics" /></p>

<p>I hope you like this article about Forensics and sorry for my bad English , i am not a native speaker (Happy Hack).</p>

<h2 id="reference">Reference</h2>

<p><a href="https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#hashdump">https://github.com/volatilityfoundation/volatility/wiki/Command-Reference#hashdump</a></p>

<p><a href="https://resources.infosecinstitute.com/memory-forensics-and-analysis-using-volatility/?fbclid=IwAR1_po75pLlt5Yg_eJOtKtaR93-lgsi8SsoIaR6t832zAtPDCQf_zsuPrSE#gref">https://resources.infosecinstitute.com/memory-forensics-and-analysis-using-volatility/?fbclid=IwAR1_po75pLlt5Yg_eJOtKtaR93-lgsi8SsoIaR6t832zAtPDCQf_zsuPrSE#gref</a></p>

<p><a href="https://www.andreafortuna.org/dfir/forensics/how-to-extract-a-ram-dump-from-a-running-virtualbox-machine/?fbclid=IwAR3V-48WZspdCtOPkqW8xpjMeG3o4rntOj4mDahVAfy5SoG5_hPJQCfwkPA">https://www.andreafortuna.org/dfir/forensics/how-to-extract-a-ram-dump-from-a-running-virtualbox-machine/?fbclid=IwAR3V-48WZspdCtOPkqW8xpjMeG3o4rntOj4mDahVAfy5SoG5_hPJQCfwkPA</a></p>

<p><a href="https://github.com/T3jv1l/Volatility-Installer">https://github.com/T3jv1l/Volatility-Installer</a></p>
